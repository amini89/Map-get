<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ğŸŒ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ - Ø±Ø¯ÛŒØ§Ø¨ÛŒ Ù…Ú©Ø§Ù†</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 0; }
        #map { height: 100vh; width: 100%; }
        .header {
            position: absolute;
            top: 15px;
            right: 15px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            z-index: 1000;
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <div class="header">ğŸ“¡ Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØªÛŒ (Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±)</div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map').setView([32.4279, 53.6880], 5); // Ù…Ø±Ú©Ø² Ø§ÛŒØ±Ø§Ù†

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap'
        }).addTo(map);

        const markers = [];

        function update() {
            fetch('/data')
                .then(res => res.json())
                .then(points => {
                    markers.forEach(m => map.removeLayer(m));
                    markers.length = 0;

                    points.forEach(p => {
                        const marker = L.marker([p.lat, p.lng])
                            .addTo(map)
                            .bindPopup(p.info);
                        markers.push(marker);
                    });
                });
        }

        update();
        setInterval(update, 4000); // Ù‡Ø± Û´ Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
    </script>
</body>
</html>
