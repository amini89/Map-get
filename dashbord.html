<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ğŸŒ Ù¾Ù†Ù„ Ú©Ù„Ø§Ø³ÛŒ - Ù†Ù‚Ø´Ù‡ Ø²Ù†Ø¯Ù‡</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
        #map { height: 100vh; width: 100%; }
        .header {
            position: absolute;
            top: 10px;
            left: 10px;
            background: white;
            padding: 10px 15px;
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="header">ğŸ“¡ Ù¾Ø±ÙˆÚ˜Ù‡ Ø¢Ù…ÙˆØ²Ø´ÛŒ - Ù…Ú©Ø§Ù†â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„â€ŒØ´Ø¯Ù‡ (Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù‡Ø± Ûµ Ø«Ø§Ù†ÛŒÙ‡)</div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        const map = L.map('map').setView([35.6892, 51.3890], 6); // Ù…Ø±Ú©Ø² Ø§ÛŒØ±Ø§Ù†

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap'
        }).addTo(map);

        const markers = [];

        function updateMap() {
            fetch('/data')
                .then(res => res.json())
                .then(points => {
                    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù…Ø§Ø±Ú©Ø±Ù‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
                    markers.forEach(marker => map.removeLayer(marker));
                    markers.length = 0;

                    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ù…Ø§Ø±Ú©Ø±Ù‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
                    points.forEach((point, i) => {
                        const marker = L.marker([point.lat, point.lng])
                            .addTo(map)
                            .bindPopup(`Ù†ÙØ± ${i + 1}<br>Ø¹Ø±Ø¶: ${point.lat.toFixed(4)}<br>Ø·ÙˆÙ„: ${point.lng.toFixed(4)}`);
                        markers.push(marker);
                    });

                    if (points.length > 0) {
                        const group = new L.featureGroup(markers);
                        map.fitBounds(group.getBounds().pad(0.2));
                    }
                });
        }

        updateMap();
        setInterval(updateMap, 5000); // Ù‡Ø± Ûµ Ø«Ø§Ù†ÛŒÙ‡ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
    </script>
</body>
</html>
